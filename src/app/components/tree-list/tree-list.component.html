<div *ngIf="hasStatus(StatusKey.TREES, StatusValue.IN_PROGRESS) || hasStatus(StatusKey.CITIES, StatusValue.IN_PROGRESS)"
     class="container load load-md">
</div>

<div class="content-cat">
  <div class="container map-wrapper">
    <ut-map
      [markers]="availableTrees"
      [selectedMarker]="selectedTree"
      (selectedMarkerChange)="selectTreeOnMap($event)"
      errorText="phenology.observation.step1.map_error_text"></ut-map>
  </div>
</div>

<div class="content-cat">
  <div class="container">
    <input
      [ngModel]="treeSearchInput"
      (ngModelChange)="setTreeSearchInput($event)"
      class="form-control form-control-lg search-input"
      [placeholder]="'phenology.observation.step1.tree_search_placeholder' | translate" />
    <div class="text-xs text-subtle">
      {{'general.input_annotation' | translate}}
    </div>
  </div>
</div>

<div *ngIf="cities?.length === 0" class="pt-3 pb-1 text-center text-subtle">
  {{'tree_list.none_found' | translate}}
</div>

<div *ngFor="let city of cities"
     class="content-cat">
  <div class="container">

    <div class="content-cat-heading mb-2">
      {{city.name}}
    </div>

    <div class="has-status-overlay m--2">

      <ng-container *ngFor="let tree of displayTrees">

        <div *ngIf="tree.location.city.id === city.id"
             class="tree-container">
          <div class="inner d-flex flex-column pointer m-2"
               [routerLink]="['/tree', tree.id]">

            <div class="title p-2">
              <i class="i i-md i-dark i-tree mr-2"></i>
              {{'tree.species.' + tree.species.name | lowercase | translate}}
            </div>
            <div class="info p-2">
              <div class="d-flex flex-row align-items-center mt-1">
                <i class="i i-xs i-black i-id mr-2"></i>
                {{'tree.species.latin.' + tree.species.name | lowercase | translate}}
              </div>
              <div class="d-flex flex-row align-items-center mt-1">
                <i class="i i-xs i-black i-location mr-2"></i>
                {{'tree_list.tree.location' | translate:tree.location}}
              </div>
              <div class="text-right mt-1">
                <a class="link">
                  {{'tree_list.tree.link' | translate}}
                </a>
              </div>
            </div>

          </div>
        </div>

      </ng-container>

    </div>

  </div>
</div>

<div *ngIf="hasAnyStatusKey([StatusKey.STATISTICS, StatusKey.TREES], StatusValue.FAILED)" class="status-overlay overlay-fixed">
  <div class="status-content">
    <div class="status-heading heading-danger">
      {{'general.error' | translate}}
    </div>
    <div class="status-text">
      {{'tree_list.error.text' | translate}}
    </div>
    <div class="status-controls">
      <button class="btn btn-light float-right" (click)="load()" (keydown)="load()">{{'general.retry' | translate}}</button>
    </div>
  </div>
</div>
